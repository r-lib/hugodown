---
title: "hugodown configuration"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{hugodown configuration}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

There are two types of configuration related to hugodown:

* hugo configuration, because hugodown assumes certain things to be true
  about your hugo setup.
  
* hugodown specific configuration, which allows you to control over various
  ways in which hugodown works.

## Hugo configuration

hugodown does not work with every possible hugo site. There is some config that we assume (typically in `config.toml`, but hugo has a bewildering array of places that this might live instead.)

*   You must use the goldmark markdown renderer, and set `unsafe: true`

    ```toml
    [markup]
      defaultMarkdownHandler = "goldmark"
      [markup.goldmark.renderer]
        unsafe = true
    ```

*   For best syntax hightlighting results, you must use classes:

    ```toml
    pygmentsUseClasses = true
    ```
    
    You then must ensure that your stylesheet defines styles for the
    CSS classes. You can generate starter css with (e.g):
    
    ```
    hugo gen chromastyles --style=pygments > static/css/pygments.css
    ```
    
    Substitute `pygments` for the [style of your choice][styles]. Unfortunately,
    the correct location for the custom `pgments.css` file varies by theme, 
    so you'll need to do a little 
    detective work to figure out the best place to save it; where to refer to it 
    (a `customCSS` param in the website configuration? a link in a custom layout? a magical file name?);
    and what existing CSS for code and `pre` might need amending.
    
    Since downlit that hugodown uses under the hood adds _links_ to code blocks, you 
    might also need to tweak CSS for links (if you notice you get wrong vertical alignment 
    of links in code for instance).

*   We recommend ignoring knitr intermediates:

    ```toml
    ignoreFiles = ['\.Rmd$', '_files$', '_cache$', '\.knit\.md$', '\.utf8\.md$']
    ```

*   To use html widgets, you must include the following Go template somewhere
    in the `<head>` layout file for your theme. This will help Hugo find the 
    HTML dependencies needed to render the widget in a post. You may find this 
    [blog post](https://zwbetz.com/override-a-hugo-theme/) helpful for 
    overriding Hugo layouts.
  
    ```
    {{ range .Params.html_dependencies }}
      {{ . | safeHTML }}
    {{ end }}
    ```

*   To use mathjax, you will need to use a series of [small hacks][yihui-mathjax]. 
    The easiest way is to copy from an existing template, like [tourmaline].
    Take note of the [`footer_mathjax.html`][footer_mathjax] partial, which
    is then included in the [`footer.html`][footer]. You'll also need to include
    [`math_code.js`][math_code] in your `static/` directory. Once that's done
    you can use inline math like `$math$`, and display math like 
    `` `$$ math $$` `` (note the extra backtick compared to usual).

## hugodown configuration

hugodown also has it's own configuration file, `_hugodown.yml`. Currently this has one option:

* `hugo_version`: this defines the version of hugo needed by the current site.

[styles]: https://xyproto.github.io/splash/docs/longer/all.html
